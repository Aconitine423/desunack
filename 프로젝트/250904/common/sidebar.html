<!-- common/sidebar.html -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

<nav class="mp-sidebar-nav" aria-label="마이페이지 메뉴" id="mp-sidebar">
  <ul class="mp-sections">

    <!-- 판매자센터 -->
    <li class="mp-section" data-role="seller">
      <div class="mp-section-title">판매자센터 (입점/셀러)</div>
      <ul class="mp-section-list">
        <li><a href="/My_page/seller/Product/index.html"><i class="fas fa-box-open"></i><span>상품 관리</span></a></li>
        <li><a href="/My_page/seller/Product/add.html"><i class="fas fa-plus-square"></i><span>상품 등록</span></a></li>
        <li><a href="/My_page/seller/Product/review.html"><i class="fas fa-star"></i><span>리뷰 관리</span></a></li>

        <li><a href="/My_page/seller/order/index.html"><i class="fas fa-shopping-bag"></i><span>주문 관리</span></a></li>
        <li><a href="/My_page/seller/Coupons/coupon.html"><i class="fas fa-ticket-alt"></i><span>쿠폰 관리</span></a></li>
        <li><a href="/My_page/seller/membership/index.html"><i class="fas fa-users"></i><span>멤버십 관리</span></a></li>

        <li><a href="/My_page/seller/account/edit.html"><i class="fas fa-user-cog"></i><span>회원정보 수정</span></a></li>
        <li><a href="/My_page/seller/account/leave.html"><i class="fas fa-sign-out-alt"></i><span>회원 탈퇴</span></a></li>
      </ul>
    </li>

  </ul>
</nav>
  
  <!-- 사이드바 스타일(간단) -->
  <style>
    /* 사이드바 기본 */
.mp-sidebar-nav {
  font-family: "Noto Sans KR", sans-serif;
  background: transparent;
}
.mp-sections {
  list-style: none;
  margin: 0;
  padding: 0;
}
.mp-section {
  margin-bottom: 12px;
}
.mp-section-title {
  color: #888;
  font-weight: 700;
  padding: 8px 10px;
  font-size: 13px;
}

.mp-section-list {
  list-style: none;
  margin: 0;
  padding: 0 6px 6px 6px;
}
.mp-section-list li {
  margin: 4px 0;
}

.mp-section-list a {
  display: flex;
  align-items: center;
  gap: 8px;
  width: 100%;
  text-decoration: none;
  color: #222;
  background: transparent;
  padding: 8px;
  border-radius: 6px;
  font-size: 14px;
}
.mp-section-list a .fas {
  width: 18px;
  text-align: center;
  color: #777;
}

/* hover & active */
.mp-section-list a:hover {
  background: #fff;
  color: #ff6f61;
}
.mp-section-list a.is-active {
  background: #fff;
  color: #ff6f61;
  font-weight: 700;
}

/* 반응형 */
@media (max-width: 900px) {
  .mp-sidebar-nav { display: none; }
}

  </style>
  
  <!-- 동작 스크립트: role 필터링, 그룹 토글, 현재경로 액티브 처리 -->
  <script>
    (function(){
      const role = document.body.dataset.userRole || 'member';
      
      // role 표시
      document.querySelectorAll('.mp-section').forEach(section=>{
        const secRole = section.getAttribute('data-role');
        if (!secRole) return;
        section.style.display = (secRole === role) ? '' : 'none';
      });
      
      // 토글 기능
      document.querySelectorAll('.group-toggle').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const li = btn.closest('li');
          const sub = li.querySelector('.sublist');
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          btn.setAttribute('aria-expanded', String(!expanded));
          sub.setAttribute('aria-hidden', String(expanded));
          li.classList.toggle('active', !expanded);
        });
      });
      
      // active 표시
      const path = location.pathname.replace(/\/+$/,'').toLowerCase() || '/';
      const links = Array.from(document.querySelectorAll('.mp-sidebar-nav a[href]'));
      
      links.forEach(a => {
        const href = (a.getAttribute('href')||'').replace(/\/+$/,'').toLowerCase() || '/';
        if (href === path || (href !== '/' && path.startsWith(href))) {
          a.classList.add('is-active');
          const li = a.closest('li');
          if (li) li.classList.add('active');
          
          const parent = a.closest('.sublist');
          if (parent) {
            parent.setAttribute('aria-hidden','false');
            const toggle = parent.parentElement.querySelector('.group-toggle');
            if (toggle) toggle.setAttribute('aria-expanded','true');
            parent.parentElement.classList.add('active');
          }
        }
      });
      // 정확 일치 우선 → 그다음 startsWith
      links.sort((a,b)=>(b.getAttribute('href')||'').length-(a.getAttribute('href')||'').length);
      
      for (const a of links){
        const href = (a.getAttribute('href')||'').replace(/\/+$/,'') || '/';
        if ((href === path) || (href !== '/' && path.startsWith(href))) {
          a.classList.add('is-active');
          const li = a.closest('li');
          if (li) li.classList.add('active');
          const parent = a.closest('.sublist');
          if (parent) {
            parent.setAttribute('aria-hidden','false');
            const toggle = parent.parentElement.querySelector('.group-toggle');
            if (toggle) toggle.setAttribute('aria-expanded','true');
            parent.parentElement.classList.add('active');
          }
          break;
        }
      }
    })();
    
  </script>
  